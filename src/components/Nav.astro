---
import { NAV_LINKS, SITE } from '../lib/constants';
---

<nav
  id="site-nav"
  class="fixed top-0 left-0 right-0 z-50 transition-colors duration-300"
>
  <div class="max-w-6xl mx-auto px-6 h-16 flex items-center justify-between">
    <!-- Logo -->
    <a href="/" class="font-display text-xl text-copper tracking-tight">
      1404
    </a>

    <!-- Desktop links -->
    <div class="hidden md:flex items-center gap-8">
      {NAV_LINKS.map((link) => (
        <a
          href={link.href}
          class="text-sm text-text-secondary hover:text-text-primary transition-colors duration-200"
        >
          {link.label}
        </a>
      ))}
      <a
        href="/contact"
        class="text-sm text-copper hover:text-copper-bright transition-colors duration-200"
      >
        Contact
      </a>
    </div>

    <!-- Mobile hamburger -->
    <button
      id="nav-toggle"
      class="md:hidden relative w-8 h-8 flex items-center justify-center"
      aria-label="Open menu"
      aria-expanded="false"
    >
      <span class="nav-bar absolute w-5 h-px bg-text-secondary transition-all duration-300 -translate-y-1.5"></span>
      <span class="nav-bar absolute w-5 h-px bg-text-secondary transition-all duration-300"></span>
      <span class="nav-bar absolute w-5 h-px bg-text-secondary transition-all duration-300 translate-y-1.5"></span>
    </button>
  </div>
</nav>

<!-- Mobile overlay -->
<div
  id="nav-overlay"
  class="fixed inset-0 z-40 bg-bg flex flex-col items-center justify-center gap-8 opacity-0 pointer-events-none transition-opacity duration-300"
>
  {NAV_LINKS.map((link) => (
    <a
      href={link.href}
      class="font-display text-3xl text-text-primary hover:text-copper transition-colors duration-200"
    >
      {link.label}
    </a>
  ))}
  <a
    href="/contact"
    class="font-display text-3xl text-copper hover:text-copper-bright transition-colors duration-200"
  >
    Contact
  </a>
</div>

<style>
  #site-nav.scrolled {
    background-color: var(--color-bg-surface);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--color-border-light);
  }

  #nav-toggle.open .nav-bar:nth-child(1) {
    transform: translateY(0) rotate(45deg);
  }
  #nav-toggle.open .nav-bar:nth-child(2) {
    opacity: 0;
  }
  #nav-toggle.open .nav-bar:nth-child(3) {
    transform: translateY(0) rotate(-45deg);
  }

  #nav-overlay.open {
    opacity: 1;
    pointer-events: auto;
  }
</style>

<script>
  const nav = document.getElementById('site-nav')!;
  const toggle = document.getElementById('nav-toggle')!;
  const overlay = document.getElementById('nav-overlay')!;

  // Scroll detection
  let ticking = false;
  function onScroll() {
    if (!ticking) {
      requestAnimationFrame(() => {
        if (window.scrollY > 32) {
          nav.classList.add('scrolled');
        } else {
          nav.classList.remove('scrolled');
        }
        ticking = false;
      });
      ticking = true;
    }
  }
  window.addEventListener('scroll', onScroll, { passive: true });
  onScroll();

  // Mobile menu toggle
  toggle.addEventListener('click', () => {
    const isOpen = toggle.classList.toggle('open');
    overlay.classList.toggle('open');
    toggle.setAttribute('aria-expanded', String(isOpen));
    document.body.style.overflow = isOpen ? 'hidden' : '';
  });

  // Close mobile menu on link click
  overlay.querySelectorAll('a').forEach((a) => {
    a.addEventListener('click', () => {
      toggle.classList.remove('open');
      overlay.classList.remove('open');
      toggle.setAttribute('aria-expanded', 'false');
      document.body.style.overflow = '';
    });
  });
</script>
